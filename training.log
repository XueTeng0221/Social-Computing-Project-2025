2025-12-23 13:51:17 - INFO - 📂 加载已有图数据...
2025-12-23 13:51:17 - INFO - 
🔍 正在检查数据质量...
2025-12-23 13:51:17 - INFO - ⚠️ 检测到异常数值，尝试将其替换为 0...
2025-12-23 13:51:17 - INFO - ⚖️ 对 User 特征进行归一化...
2025-12-23 13:51:17 - INFO - ✅ 数据检查与预处理完成
2025-12-23 13:51:17 - INFO - 
📊 标签分布统计:
2025-12-23 13:51:17 - INFO -   - 总样本数: 2915
2025-12-23 13:51:17 - INFO -   - 欺诈样本 (Label=1): 557 (19.11%)
2025-12-23 13:51:17 - INFO -   - 正常样本 (Label=0): 2358 (80.89%)
2025-12-23 13:51:17 - INFO - 💡 建议 Focal Loss Alpha: 0.8089
2025-12-23 13:51:17 - INFO - 🖥️  使用设备: cuda
2025-12-23 13:51:17 - INFO - 📊 数据集划分: Train 2040 | Val 437 | Test 438
2025-12-23 13:51:17 - INFO - 🚀 模型初始化完成
2025-12-23 13:51:18 - INFO - Epoch 01: Loss 0.0883 | Val F1 0.4103 | Val AUC 0.8323 | Precision 0.2606 | Recall 0.9639
2025-12-23 13:51:18 - INFO -   ✅ 保存最佳模型 (F1=0.4103)
2025-12-23 13:51:18 - INFO - Epoch 02: Loss 0.0885 | Val F1 0.4375 | Val AUC 0.8326 | Precision 0.2862 | Recall 0.9277
2025-12-23 13:51:18 - INFO -   ✅ 保存最佳模型 (F1=0.4375)
2025-12-23 13:51:18 - INFO - Epoch 03: Loss 0.0868 | Val F1 0.4653 | Val AUC 0.8346 | Precision 0.3105 | Recall 0.9277
2025-12-23 13:51:18 - INFO -   ✅ 保存最佳模型 (F1=0.4653)
2025-12-23 13:51:18 - INFO - Epoch 04: Loss 0.0855 | Val F1 0.4750 | Val AUC 0.8367 | Precision 0.3207 | Recall 0.9157
2025-12-23 13:51:18 - INFO -   ✅ 保存最佳模型 (F1=0.4750)
2025-12-23 13:51:18 - INFO - Epoch 05: Loss 0.0837 | Val F1 0.4795 | Val AUC 0.8391 | Precision 0.3248 | Recall 0.9157
2025-12-23 13:51:18 - INFO -   ✅ 保存最佳模型 (F1=0.4795)
2025-12-23 13:51:18 - INFO - Epoch 06: Loss 0.0836 | Val F1 0.4887 | Val AUC 0.8410 | Precision 0.3333 | Recall 0.9157
2025-12-23 13:51:18 - INFO -   ✅ 保存最佳模型 (F1=0.4887)
2025-12-23 13:51:18 - INFO - Epoch 07: Loss 0.0830 | Val F1 0.5086 | Val AUC 0.8426 | Precision 0.3558 | Recall 0.8916
2025-12-23 13:51:18 - INFO -   ✅ 保存最佳模型 (F1=0.5086)
2025-12-23 13:51:18 - INFO - Epoch 08: Loss 0.0819 | Val F1 0.5211 | Val AUC 0.8435 | Precision 0.3682 | Recall 0.8916
2025-12-23 13:51:18 - INFO -   ✅ 保存最佳模型 (F1=0.5211)
2025-12-23 13:51:18 - INFO - Epoch 09: Loss 0.0795 | Val F1 0.5248 | Val AUC 0.8435 | Precision 0.3719 | Recall 0.8916
2025-12-23 13:51:18 - INFO -   ✅ 保存最佳模型 (F1=0.5248)
2025-12-23 13:51:18 - INFO - Epoch 10: Loss 0.0796 | Val F1 0.5343 | Val AUC 0.8440 | Precision 0.3814 | Recall 0.8916
2025-12-23 13:51:18 - INFO -   ✅ 保存最佳模型 (F1=0.5343)
2025-12-23 13:51:18 - INFO - Epoch 11: Loss 0.0788 | Val F1 0.5468 | Val AUC 0.8439 | Precision 0.3967 | Recall 0.8795
2025-12-23 13:51:18 - INFO -   ✅ 保存最佳模型 (F1=0.5468)
2025-12-23 13:51:18 - INFO - Epoch 12: Loss 0.0772 | Val F1 0.5615 | Val AUC 0.8438 | Precision 0.4124 | Recall 0.8795
2025-12-23 13:51:18 - INFO -   ✅ 保存最佳模型 (F1=0.5615)
2025-12-23 13:51:18 - INFO - Epoch 13: Loss 0.0765 | Val F1 0.5635 | Val AUC 0.8447 | Precision 0.4201 | Recall 0.8554
2025-12-23 13:51:18 - INFO -   ✅ 保存最佳模型 (F1=0.5635)
2025-12-23 13:51:18 - INFO - Epoch 14: Loss 0.0756 | Val F1 0.5726 | Val AUC 0.8447 | Precision 0.4303 | Recall 0.8554
2025-12-23 13:51:18 - INFO -   ✅ 保存最佳模型 (F1=0.5726)
2025-12-23 13:51:18 - INFO - Epoch 15: Loss 0.0755 | Val F1 0.5691 | Val AUC 0.8450 | Precision 0.4294 | Recall 0.8434
2025-12-23 13:51:18 - INFO - Epoch 16: Loss 0.0748 | Val F1 0.5761 | Val AUC 0.8453 | Precision 0.4375 | Recall 0.8434
2025-12-23 13:51:18 - INFO -   ✅ 保存最佳模型 (F1=0.5761)
2025-12-23 13:51:18 - INFO - Epoch 17: Loss 0.0740 | Val F1 0.5750 | Val AUC 0.8451 | Precision 0.4395 | Recall 0.8313
2025-12-23 13:51:18 - INFO - Epoch 18: Loss 0.0720 | Val F1 0.5654 | Val AUC 0.8450 | Precision 0.4351 | Recall 0.8072
2025-12-23 13:51:18 - INFO - Epoch 19: Loss 0.0713 | Val F1 0.5617 | Val AUC 0.8452 | Precision 0.4342 | Recall 0.7952
2025-12-23 13:51:19 - INFO - Epoch 20: Loss 0.0709 | Val F1 0.5579 | Val AUC 0.8456 | Precision 0.4333 | Recall 0.7831
2025-12-23 13:51:19 - INFO - Epoch 21: Loss 0.0700 | Val F1 0.5603 | Val AUC 0.8458 | Precision 0.4362 | Recall 0.7831
2025-12-23 13:51:19 - INFO - Epoch 22: Loss 0.0705 | Val F1 0.5603 | Val AUC 0.8463 | Precision 0.4362 | Recall 0.7831
2025-12-23 13:51:19 - INFO - Epoch 23: Loss 0.0701 | Val F1 0.5628 | Val AUC 0.8468 | Precision 0.4392 | Recall 0.7831
2025-12-23 13:51:19 - INFO - Epoch 24: Loss 0.0689 | Val F1 0.5652 | Val AUC 0.8472 | Precision 0.4422 | Recall 0.7831
2025-12-23 13:51:19 - INFO - Epoch 25: Loss 0.0699 | Val F1 0.5628 | Val AUC 0.8478 | Precision 0.4392 | Recall 0.7831
2025-12-23 13:51:19 - INFO - Epoch 26: Loss 0.0686 | Val F1 0.5628 | Val AUC 0.8484 | Precision 0.4392 | Recall 0.7831
2025-12-23 13:51:19 - INFO - Epoch 27: Loss 0.0688 | Val F1 0.5628 | Val AUC 0.8490 | Precision 0.4392 | Recall 0.7831
2025-12-23 13:51:19 - INFO - Epoch 28: Loss 0.0662 | Val F1 0.5628 | Val AUC 0.8496 | Precision 0.4392 | Recall 0.7831
2025-12-23 13:51:19 - INFO - Epoch 29: Loss 0.0678 | Val F1 0.5628 | Val AUC 0.8497 | Precision 0.4392 | Recall 0.7831
2025-12-23 13:51:19 - INFO - Epoch 30: Loss 0.0661 | Val F1 0.5603 | Val AUC 0.8502 | Precision 0.4362 | Recall 0.7831
2025-12-23 13:51:19 - INFO - Epoch 31: Loss 0.0655 | Val F1 0.5641 | Val AUC 0.8506 | Precision 0.4371 | Recall 0.7952
2025-12-23 13:51:19 - INFO - Epoch 32: Loss 0.0665 | Val F1 0.5702 | Val AUC 0.8511 | Precision 0.4408 | Recall 0.8072
2025-12-23 13:51:19 - INFO - Epoch 33: Loss 0.0670 | Val F1 0.5702 | Val AUC 0.8516 | Precision 0.4408 | Recall 0.8072
2025-12-23 13:51:19 - INFO - Epoch 34: Loss 0.0670 | Val F1 0.5763 | Val AUC 0.8520 | Precision 0.4444 | Recall 0.8193
2025-12-23 13:51:19 - INFO -   ✅ 保存最佳模型 (F1=0.5763)
2025-12-23 13:51:19 - INFO - Epoch 35: Loss 0.0661 | Val F1 0.5763 | Val AUC 0.8530 | Precision 0.4444 | Recall 0.8193
2025-12-23 13:51:19 - INFO -   ✅ 保存最佳模型 (F1=0.5763)
2025-12-23 13:51:19 - INFO - Epoch 36: Loss 0.0661 | Val F1 0.5823 | Val AUC 0.8536 | Precision 0.4481 | Recall 0.8313
2025-12-23 13:51:19 - INFO -   ✅ 保存最佳模型 (F1=0.5823)
2025-12-23 13:51:19 - INFO - Epoch 37: Loss 0.0656 | Val F1 0.5798 | Val AUC 0.8543 | Precision 0.4452 | Recall 0.8313
2025-12-23 13:51:19 - INFO - Epoch 38: Loss 0.0639 | Val F1 0.5798 | Val AUC 0.8548 | Precision 0.4452 | Recall 0.8313
2025-12-23 13:51:19 - INFO - Epoch 39: Loss 0.0653 | Val F1 0.5823 | Val AUC 0.8553 | Precision 0.4481 | Recall 0.8313
2025-12-23 13:51:19 - INFO -   ✅ 保存最佳模型 (F1=0.5823)
2025-12-23 13:51:20 - INFO - Epoch 40: Loss 0.0637 | Val F1 0.5823 | Val AUC 0.8562 | Precision 0.4481 | Recall 0.8313
2025-12-23 13:51:20 - INFO -   ✅ 保存最佳模型 (F1=0.5823)
2025-12-23 13:51:20 - INFO - Epoch 41: Loss 0.0628 | Val F1 0.5823 | Val AUC 0.8564 | Precision 0.4481 | Recall 0.8313
2025-12-23 13:51:20 - INFO -   ✅ 保存最佳模型 (F1=0.5823)
2025-12-23 13:51:20 - INFO - Epoch 42: Loss 0.0632 | Val F1 0.5798 | Val AUC 0.8573 | Precision 0.4452 | Recall 0.8313
2025-12-23 13:51:20 - INFO - Epoch 43: Loss 0.0641 | Val F1 0.5798 | Val AUC 0.8577 | Precision 0.4452 | Recall 0.8313
2025-12-23 13:51:20 - INFO - Epoch 44: Loss 0.0632 | Val F1 0.5798 | Val AUC 0.8579 | Precision 0.4452 | Recall 0.8313
2025-12-23 13:51:20 - INFO - Epoch 45: Loss 0.0617 | Val F1 0.5823 | Val AUC 0.8582 | Precision 0.4481 | Recall 0.8313
2025-12-23 13:51:20 - INFO -   ✅ 保存最佳模型 (F1=0.5823)
2025-12-23 13:51:20 - INFO - Epoch 46: Loss 0.0626 | Val F1 0.5823 | Val AUC 0.8592 | Precision 0.4481 | Recall 0.8313
2025-12-23 13:51:20 - INFO -   ✅ 保存最佳模型 (F1=0.5823)
2025-12-23 13:51:20 - INFO - Epoch 47: Loss 0.0628 | Val F1 0.5798 | Val AUC 0.8599 | Precision 0.4452 | Recall 0.8313
2025-12-23 13:51:20 - INFO - Epoch 48: Loss 0.0626 | Val F1 0.5798 | Val AUC 0.8607 | Precision 0.4452 | Recall 0.8313
2025-12-23 13:51:20 - INFO - Epoch 49: Loss 0.0620 | Val F1 0.5798 | Val AUC 0.8612 | Precision 0.4452 | Recall 0.8313
2025-12-23 13:51:20 - INFO - Epoch 50: Loss 0.0632 | Val F1 0.5823 | Val AUC 0.8619 | Precision 0.4481 | Recall 0.8313
2025-12-23 13:51:20 - INFO -   ✅ 保存最佳模型 (F1=0.5823)
2025-12-23 13:51:20 - INFO - 
🎉 训练完成!
2025-12-23 13:51:20 - INFO - 
🔍 加载最佳模型进行测试...
2025-12-23 13:51:20 - INFO - 🎯 测试集性能: F1 0.6148 | AUC 0.8816 | Precision 0.4777 | Recall 0.8621
2025-12-23 13:51:20 - INFO - 
🎨 正在绘制结果图...
